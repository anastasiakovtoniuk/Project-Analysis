# Datasets Outline

## Existing Local Assets
- `dataset/saveecobot_cities_pm25_and_aqi_pm25_2019.csv` … `dataset/saveecobot_cities_pm25_and_aqi_pm25_2023.csv`
  - Hourly PM2.5 concentration (µg/m³) and NowCast AQI by `city_id` with timestamp column `logged_at` (UTC). Coverage runs 2019-01-01→2023-12-31. Expect gaps during outages/maintenance; a completeness audit is required per city-year.
  - Action: consolidate into a single partitioned table (e.g., Parquet) keyed by `city_id`, `logged_at`; add calendar attributes (local date, hour, season).
- `dataset/saveecobot-cities-pm25-and-aqi-pm25.csv`
  - Combined dump spanning 2019-02-27 onward (currently through 2025-01-31). Passed via `--archive-csv` during ingestion to append 2024–2025 rows while avoiding duplicates for earlier years.
- `dataset/saveecobot_cities.csv`
  - City reference table: Ukrainian/Romanized names, administrative units, KOATUU/KATOTTG codes. Needed for labeling, regional grouping, and potential joins to external data (population, conflict exposure).

## Derived Tables Produced by Pipeline
- `data/raw/city_hourly_<year>.parquet`
  - Year-partitioned parquet emitted by the ingest stage. Contains UTC and localised timestamps plus source-file provenance for reproducibility.
- `data/processed/city_hourly_pm25.parquet`
  - Hourly records enriched with local calendar fields, quality flags, city metadata, and wartime indicator. Filtered to cities meeting the longitudinal coverage rule (≥70% daily coverage across ≥4 years with ≥2 pre-war and ≥2 wartime years).
- `data/processed/city_daily_pm25.parquet`
  - Daily roll-ups with descriptive statistics (mean/median/p90/p10/max), available hour counts, and exceedance share relative to the WHO 15 µg/m³ guideline; only eligible cities retained.
- `data/processed/city_distributions.parquet`
  - Period- and year-level summaries per city (medians, spreads, coverage diagnostics) for the eligible sensor network.
- `data/processed/region_period_pm25.parquet`
  - Region (oblast) aggregates merged with administrative geometry (`geometry`, `koatuu`) for choropleth production.
- `outputs/qa/city_year_coverage.csv`
  - Coverage diagnostics (days observed, available hours, exceedance means) generated by the QA stage; supports narrative around data gaps.
- `outputs/figures/*.png`
  - Publication-ready graphics rendered via `python -m src.visualization.run`; each file corresponds to an entry in `Graphics-Outline.md`.

## External / Supplemental Data Needs
- **Administrative Boundaries for Choropleth**
  - Source: Official Ukrainian administrative territorial units (KATOTTG) polygons via Ministry for Communities and Territories or Humanitarian Data Exchange (`ukr_admbnda_adm2_2023.shp`).
  - Usage: Join city-level metrics to geometry using `koatuu`/`katottg`; if a city is missing, approximate via centroid coordinates.
  - Acquisition: Download geopackage/GeoJSON, store under `dataset/geo/`, convert to simplified GeoJSON for plotting.
- Air-raid or attack intensity timeline (e.g., HEAVY: siren API, ACLED, or verified open datasets). Enables contextual markers for wartime spikes; please advise on preferred source if not readily available.
- Meteorological covariates (temperature, boundary-layer height, wind) from ERA5 or Ukrainian Met Service for seasonality control. Optional but improves interpretation of anomalies.
- Population or sensor metadata (station counts per city) to normalize exposure comparisons. Could be drawn from SaveEcoBot API or Ukrainian statistics portals.

## Validation Tasks
- Compare aggregates against SaveEcoBot dashboard statistics to ensure ingestion correctness.
- Document periods of missing data per city (e.g., via completeness matrix) to avoid misleading graphics.
- Verify administrative boundary joins by spot-checking a few city polygons and labels on the map output.
